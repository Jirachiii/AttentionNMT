[2022-12-05 11:09:04,711 INFO] Missing transforms field for corpus_1 data, set to default: [].
[2022-12-05 11:09:04,711 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2022-12-05 11:09:04,711 INFO] Missing transforms field for valid data, set to default: [].
[2022-12-05 11:09:04,711 INFO] Parsed 2 corpora from -data.
[2022-12-05 11:09:04,711 INFO] Get special vocabs from Transforms: {'src': set(), 'tgt': set()}.
[2022-12-05 11:09:04,712 INFO] Loading vocab from text file...
[2022-12-05 11:09:04,712 INFO] Loading src vocabulary from run/test.vocab.src
[2022-12-05 11:09:04,743 INFO] Loaded src vocab has 31563 tokens.
[2022-12-05 11:09:04,750 INFO] Loading tgt vocabulary from run/test.vocab.tgt
[2022-12-05 11:09:04,841 INFO] Loaded tgt vocab has 58824 tokens.
[2022-12-05 11:09:04,855 INFO] Building fields with vocab in counters...
[2022-12-05 11:09:04,934 INFO]  * tgt vocab size: 50004.
[2022-12-05 11:09:04,957 INFO]  * src vocab size: 31565.
[2022-12-05 11:09:04,959 INFO]  * src vocab size = 31565
[2022-12-05 11:09:04,959 INFO]  * tgt vocab size = 50004
[2022-12-05 11:09:04,960 INFO] Building model...
[2022-12-05 11:09:06,843 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(31565, 512, padding_idx=1)
        )
      )
    )
    (rnn): GRU(512, 256, num_layers=2, dropout=0.1, bidirectional=True)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(50004, 512, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (rnn): StackedGRU(
      (dropout): Dropout(p=0.1, inplace=False)
      (layers): ModuleList(
        (0): GRUCell(1024, 512)
        (1): GRUCell(512, 512)
      )
    )
    (attn): GlobalAttention(
      (linear_context): Linear(in_features=512, out_features=512, bias=False)
      (linear_query): Linear(in_features=512, out_features=512, bias=True)
      (v): Linear(in_features=512, out_features=1, bias=False)
      (linear_out): Linear(in_features=1024, out_features=512, bias=True)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=512, out_features=50004, bias=False)
    (1): Cast()
    (2): LogSoftmax(dim=-1)
  )
)
[2022-12-05 11:09:06,843 INFO] encoder: 18526720
[2022-12-05 11:09:06,843 INFO] decoder: 56192512
[2022-12-05 11:09:06,843 INFO] * number of parameters: 74719232
[2022-12-05 11:09:06,844 INFO] Starting training on GPU: [0]
[2022-12-05 11:09:06,845 INFO] Start training loop and validate every 2000 steps...
[2022-12-05 11:09:06,845 INFO] corpus_1's transforms: TransformPipe()
[2022-12-05 11:09:06,845 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:11:05,600 INFO] Step 1000/40000; acc:  45.27; ppl: 30.93; xent: 3.43; lr: 0.00100; 6296/7317 tok/s;    119 sec
[2022-12-05 11:12:24,404 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:13:05,991 INFO] Step 2000/40000; acc:  61.43; ppl:  7.92; xent: 2.07; lr: 0.00100; 6204/7229 tok/s;    239 sec
[2022-12-05 11:13:05,992 INFO] valid's transforms: TransformPipe()
[2022-12-05 11:13:05,992 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:13:26,262 INFO] Validation perplexity: 7.15209
[2022-12-05 11:13:26,262 INFO] Validation accuracy: 65.3132
[2022-12-05 11:15:25,020 INFO] Step 3000/40000; acc:  67.62; ppl:  4.84; xent: 1.58; lr: 0.00100; 5373/6251 tok/s;    378 sec
[2022-12-05 11:16:02,986 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:17:24,806 INFO] Step 4000/40000; acc:  71.03; ppl:  3.79; xent: 1.33; lr: 0.00100; 6245/7262 tok/s;    498 sec
[2022-12-05 11:17:24,807 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:17:45,445 INFO] Validation perplexity: 5.37946
[2022-12-05 11:17:45,445 INFO] Validation accuracy: 69.1239
[2022-12-05 11:20:10,322 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:20:13,942 INFO] Step 5000/40000; acc:  74.17; ppl:  3.12; xent: 1.14; lr: 0.00100; 4409/5137 tok/s;    667 sec
[2022-12-05 11:22:12,644 INFO] Step 6000/40000; acc:  76.61; ppl:  2.73; xent: 1.00; lr: 0.00100; 6306/7330 tok/s;    786 sec
[2022-12-05 11:22:12,644 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:22:33,205 INFO] Validation perplexity: 4.94401
[2022-12-05 11:22:33,205 INFO] Validation accuracy: 70.4478
[2022-12-05 11:23:50,990 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:24:35,493 INFO] Step 7000/40000; acc:  78.74; ppl:  2.48; xent: 0.91; lr: 0.00100; 5226/6088 tok/s;    929 sec
[2022-12-05 11:26:35,508 INFO] Step 8000/40000; acc:  80.51; ppl:  2.29; xent: 0.83; lr: 0.00100; 6228/7249 tok/s;   1049 sec
[2022-12-05 11:26:35,508 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:26:55,951 INFO] Validation perplexity: 4.90152
[2022-12-05 11:26:55,951 INFO] Validation accuracy: 71.3338
[2022-12-05 11:28:03,113 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:28:54,836 INFO] Step 9000/40000; acc:  81.66; ppl:  2.18; xent: 0.78; lr: 0.00100; 5366/6237 tok/s;   1188 sec
[2022-12-05 11:30:55,346 INFO] Step 10000/40000; acc:  82.73; ppl:  2.09; xent: 0.74; lr: 0.00100; 6199/7225 tok/s;   1309 sec
[2022-12-05 11:30:55,346 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:31:15,959 INFO] Validation perplexity: 4.72036
[2022-12-05 11:31:15,959 INFO] Validation accuracy: 71.8727
[2022-12-05 11:31:16,126 INFO] Saving checkpoint run/bahdanau/bahdanau_attn_step_10000.pt
[2022-12-05 11:31:44,511 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:33:17,790 INFO] Step 11000/40000; acc:  83.53; ppl:  2.02; xent: 0.70; lr: 0.00100; 5246/6097 tok/s;   1451 sec
[2022-12-05 11:35:04,886 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:35:18,774 INFO] Step 12000/40000; acc:  84.34; ppl:  1.96; xent: 0.67; lr: 0.00100; 6169/7180 tok/s;   1572 sec
[2022-12-05 11:35:18,774 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:35:39,125 INFO] Validation perplexity: 4.79151
[2022-12-05 11:35:39,126 INFO] Validation accuracy: 72.0155
[2022-12-05 11:37:39,039 INFO] Step 13000/40000; acc:  84.98; ppl:  1.91; xent: 0.65; lr: 0.00100; 5329/6206 tok/s;   1712 sec
[2022-12-05 11:38:44,185 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:39:37,823 INFO] Step 14000/40000; acc:  85.63; ppl:  1.87; xent: 0.62; lr: 0.00100; 6289/7314 tok/s;   1831 sec
[2022-12-05 11:39:37,823 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:39:58,435 INFO] Validation perplexity: 4.84492
[2022-12-05 11:39:58,436 INFO] Validation accuracy: 72.2401
[2022-12-05 11:41:57,685 INFO] Step 15000/40000; acc:  86.17; ppl:  1.83; xent: 0.60; lr: 0.00100; 5343/6218 tok/s;   1971 sec
[2022-12-05 11:42:55,216 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:43:57,021 INFO] Step 16000/40000; acc:  86.59; ppl:  1.80; xent: 0.59; lr: 0.00100; 6261/7282 tok/s;   2090 sec
[2022-12-05 11:43:57,021 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:44:17,383 INFO] Validation perplexity: 4.93624
[2022-12-05 11:44:17,383 INFO] Validation accuracy: 72.2085
[2022-12-05 11:46:18,726 INFO] Step 17000/40000; acc:  87.08; ppl:  1.77; xent: 0.57; lr: 0.00100; 5278/6140 tok/s;   2232 sec
[2022-12-05 11:46:35,748 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:48:19,638 INFO] Step 18000/40000; acc:  87.34; ppl:  1.75; xent: 0.56; lr: 0.00100; 6175/7195 tok/s;   2353 sec
[2022-12-05 11:48:19,638 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:48:40,319 INFO] Validation perplexity: 4.94043
[2022-12-05 11:48:40,319 INFO] Validation accuracy: 72.3561
[2022-12-05 11:50:15,376 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:50:39,287 INFO] Step 19000/40000; acc:  87.82; ppl:  1.72; xent: 0.54; lr: 0.00100; 5350/6215 tok/s;   2492 sec
[2022-12-05 11:52:40,187 INFO] Step 20000/40000; acc:  88.07; ppl:  1.71; xent: 0.53; lr: 0.00100; 6185/7207 tok/s;   2613 sec
[2022-12-05 11:52:40,188 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:53:00,883 INFO] Validation perplexity: 5.02152
[2022-12-05 11:53:00,883 INFO] Validation accuracy: 72.478
[2022-12-05 11:53:01,046 INFO] Saving checkpoint run/bahdanau/bahdanau_attn_step_20000.pt
[2022-12-05 11:53:56,553 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:54:59,028 INFO] Step 21000/40000; acc:  88.41; ppl:  1.68; xent: 0.52; lr: 0.00100; 5380/6256 tok/s;   2752 sec
[2022-12-05 11:56:58,039 INFO] Step 22000/40000; acc:  88.65; ppl:  1.67; xent: 0.51; lr: 0.00100; 6277/7302 tok/s;   2871 sec
[2022-12-05 11:56:58,039 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 11:57:18,699 INFO] Validation perplexity: 5.05663
[2022-12-05 11:57:18,699 INFO] Validation accuracy: 72.6251
[2022-12-05 11:58:05,728 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 11:59:20,069 INFO] Step 23000/40000; acc:  88.87; ppl:  1.65; xent: 0.50; lr: 0.00100; 5259/6125 tok/s;   3013 sec
[2022-12-05 12:01:20,338 INFO] Step 24000/40000; acc:  89.15; ppl:  1.64; xent: 0.50; lr: 0.00100; 6214/7227 tok/s;   3133 sec
[2022-12-05 12:01:20,338 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:01:41,150 INFO] Validation perplexity: 5.09268
[2022-12-05 12:01:41,151 INFO] Validation accuracy: 72.2454
[2022-12-05 12:01:48,116 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:03:39,890 INFO] Step 25000/40000; acc:  89.29; ppl:  1.63; xent: 0.49; lr: 0.00100; 5354/6231 tok/s;   3273 sec
[2022-12-05 12:05:05,156 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:05:39,476 INFO] Step 26000/40000; acc:  89.53; ppl:  1.62; xent: 0.48; lr: 0.00100; 6242/7267 tok/s;   3393 sec
[2022-12-05 12:05:39,476 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:06:00,061 INFO] Validation perplexity: 5.16747
[2022-12-05 12:06:00,062 INFO] Validation accuracy: 72.3828
[2022-12-05 12:07:59,164 INFO] Step 27000/40000; acc:  89.75; ppl:  1.61; xent: 0.47; lr: 0.00100; 5354/6230 tok/s;   3532 sec
[2022-12-05 12:08:44,332 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:10:00,777 INFO] Step 28000/40000; acc:  89.93; ppl:  1.59; xent: 0.47; lr: 0.00100; 6140/7149 tok/s;   3654 sec
[2022-12-05 12:10:00,778 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:10:21,648 INFO] Validation perplexity: 5.20573
[2022-12-05 12:10:21,648 INFO] Validation accuracy: 72.617
[2022-12-05 12:12:21,626 INFO] Step 29000/40000; acc:  90.10; ppl:  1.59; xent: 0.46; lr: 0.00100; 5302/6170 tok/s;   3795 sec
[2022-12-05 12:12:58,537 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:14:22,642 INFO] Step 30000/40000; acc:  90.20; ppl:  1.58; xent: 0.46; lr: 0.00100; 6182/7188 tok/s;   3916 sec
[2022-12-05 12:14:22,643 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:14:43,193 INFO] Validation perplexity: 5.24351
[2022-12-05 12:14:43,193 INFO] Validation accuracy: 72.6475
[2022-12-05 12:14:43,355 INFO] Saving checkpoint run/bahdanau/bahdanau_attn_step_30000.pt
[2022-12-05 12:16:40,202 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:16:45,300 INFO] Step 31000/40000; acc:  90.39; ppl:  1.57; xent: 0.45; lr: 0.00100; 5230/6091 tok/s;   4058 sec
[2022-12-05 12:18:44,386 INFO] Step 32000/40000; acc:  90.43; ppl:  1.57; xent: 0.45; lr: 0.00100; 6278/7294 tok/s;   4178 sec
[2022-12-05 12:18:44,386 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:19:04,939 INFO] Validation perplexity: 5.21857
[2022-12-05 12:19:04,939 INFO] Validation accuracy: 72.6277
[2022-12-05 12:20:21,281 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:21:07,065 INFO] Step 33000/40000; acc:  90.62; ppl:  1.56; xent: 0.44; lr: 0.00100; 5237/6099 tok/s;   4320 sec
[2022-12-05 12:23:06,851 INFO] Step 34000/40000; acc:  90.86; ppl:  1.55; xent: 0.44; lr: 0.00100; 6237/7258 tok/s;   4440 sec
[2022-12-05 12:23:06,851 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:23:27,434 INFO] Validation perplexity: 5.30223
[2022-12-05 12:23:27,435 INFO] Validation accuracy: 72.6614
[2022-12-05 12:24:02,116 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:25:26,637 INFO] Step 35000/40000; acc:  90.88; ppl:  1.54; xent: 0.43; lr: 0.00100; 5345/6216 tok/s;   4580 sec
[2022-12-05 12:27:26,177 INFO] Step 36000/40000; acc:  90.98; ppl:  1.54; xent: 0.43; lr: 0.00100; 6241/7263 tok/s;   4699 sec
[2022-12-05 12:27:26,177 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:27:46,735 INFO] Validation perplexity: 5.31264
[2022-12-05 12:27:46,735 INFO] Validation accuracy: 72.7389
[2022-12-05 12:28:12,844 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:29:46,761 INFO] Step 37000/40000; acc:  91.04; ppl:  1.53; xent: 0.43; lr: 0.00100; 5316/6189 tok/s;   4840 sec
[2022-12-05 12:31:33,079 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:31:47,759 INFO] Step 38000/40000; acc:  91.24; ppl:  1.52; xent: 0.42; lr: 0.00100; 6180/7182 tok/s;   4961 sec
[2022-12-05 12:31:47,760 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:32:08,316 INFO] Validation perplexity: 5.36579
[2022-12-05 12:32:08,316 INFO] Validation accuracy: 72.5882
[2022-12-05 12:34:09,748 INFO] Step 39000/40000; acc:  91.31; ppl:  1.52; xent: 0.42; lr: 0.00100; 5261/6133 tok/s;   5103 sec
[2022-12-05 12:35:13,624 INFO] Loading ParallelCorpus(data/src/src-train.txt, data/trg/trg-train.txt, align=None)...
[2022-12-05 12:36:08,284 INFO] Step 40000/40000; acc:  91.32; ppl:  1.52; xent: 0.42; lr: 0.00100; 6301/7331 tok/s;   5221 sec
[2022-12-05 12:36:08,284 INFO] Loading ParallelCorpus(data/src/src-val.txt, data/trg/trg-val.txt, align=None)...
[2022-12-05 12:36:28,892 INFO] Validation perplexity: 5.36341
[2022-12-05 12:36:28,892 INFO] Validation accuracy: 72.586
[2022-12-05 12:36:29,056 INFO] Saving checkpoint run/bahdanau/bahdanau_attn_step_40000.pt

bahdanau_attn_step_10000:
{
 "name": "BLEU",
 "score": 40.9,
 "signature": "nrefs:1|case:mixed|eff:no|tok:13a|smooth:exp|version:2.3.1",
 "verbose_score": "68.2/46.1/34.1/26.1 (BP = 1.000 ratio = 1.033 hyp_len = 195506 ref_len = 189213)",
 "nrefs": "1",
 "case": "mixed",
 "eff": "no",
 "tok": "13a",
 "smooth": "exp",
 "version": "2.3.1"
}
bahdanau_attn_step_20000:
{
 "name": "BLEU",
 "score": 42.1,
 "signature": "nrefs:1|case:mixed|eff:no|tok:13a|smooth:exp|version:2.3.1",
 "verbose_score": "68.8/47.1/35.4/27.5 (BP = 1.000 ratio = 1.025 hyp_len = 195506 ref_len = 190679)",
 "nrefs": "1",
 "case": "mixed",
 "eff": "no",
 "tok": "13a",
 "smooth": "exp",
 "version": "2.3.1"
}
bahdanau_attn_step_30000:
{
 "name": "BLEU",
 "score": 42.2,
 "signature": "nrefs:1|case:mixed|eff:no|tok:13a|smooth:exp|version:2.3.1",
 "verbose_score": "69.1/47.4/35.6/27.8 (BP = 1.000 ratio = 1.023 hyp_len = 195506 ref_len = 191024)",
 "nrefs": "1",
 "case": "mixed",
 "eff": "no",
 "tok": "13a",
 "smooth": "exp",
 "version": "2.3.1"
}
bahdanau_attn_step_40000:
{
 "name": "BLEU",
 "score": 42.4,
 "signature": "nrefs:1|case:mixed|eff:no|tok:13a|smooth:exp|version:2.3.1",
 "verbose_score": "69.1/47.4/35.6/27.8 (BP = 1.000 ratio = 1.023 hyp_len = 195506 ref_len = 191024)",
 "nrefs": "1",
 "case": "mixed",
 "eff": "no",
 "tok": "13a",
 "smooth": "exp",
 "version": "2.3.1"
}
